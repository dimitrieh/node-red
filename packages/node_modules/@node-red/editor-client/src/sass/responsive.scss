/**
 * Copyright JS Foundation and other contributors, http://js.foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/

// Mobile First Responsive Design for Node-RED

// Breakpoints
$mobile: 480px;
$tablet: 768px;
$desktop: 1024px;

// Mobile Optimizations
@media only screen and (max-width: $mobile) {
    // Touch-friendly minimum sizes
    .red-ui-button,
    .button,
    a.red-ui-footer-button,
    button.red-ui-footer-button {
        min-height: 44px;
        min-width: 44px;
        padding: 12px 16px;
        font-size: 16px; // Prevent zoom on iOS
    }

    // Header optimizations
    #red-ui-header {
        padding: 0 8px;
        height: 56px; // Taller for touch
        
        span.red-ui-header-logo {
            font-size: 18px;
            
            span {
                font-size: 14px !important;
                &:not(:first-child) {
                    margin-left: 4px;
                }
            }
            
            img {
                height: 24px;
            }
        }

        .button {
            padding: 8px 12px;
            font-size: 18px;
            margin: 2px;
            min-width: 40px;
        }
    }

    // Main container adjustments
    #red-ui-main-container {
        top: 56px;
    }

    // Mobile palette behavior - overlay style
    #red-ui-palette {
        position: fixed;
        top: 56px;
        left: 0;
        width: 280px; // Wider on mobile
        height: calc(100vh - 56px);
        z-index: 1000;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        background: var(--red-ui-primary-background);
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        
        &.red-ui-palette-open {
            transform: translateX(0);
        }
    }

    // Workspace adjustments when palette is hidden
    #red-ui-workspace {
        left: 0;
        right: 0;
        transition: none;
    }

    // Mobile sidebar behavior
    #red-ui-sidebar {
        position: fixed;
        top: 56px;
        right: 0;
        width: 90vw;
        max-width: 400px;
        height: calc(100vh - 56px);
        z-index: 1000;
        transform: translateX(100%);
        transition: transform 0.3s ease-in-out;
        background: var(--red-ui-secondary-background);
        box-shadow: -2px 0 10px rgba(0, 0, 0, 0.3);
        
        &.red-ui-sidebar-open {
            transform: translateX(0);
        }
    }

    // Hide desktop-specific elements
    .red-ui-deploy-button-group:not(.readOnly) .fa-caret-down {
        display: none;
    }

    // Workspace chart optimizations
    #red-ui-workspace-chart {
        touch-action: pan-x pan-y;
        
        // Larger touch targets for nodes
        .red-ui-flow-node {
            min-width: 44px;
            min-height: 32px;
        }
    }

    // Form optimizations
    input[type="text"],
    input[type="number"],
    input[type="email"],
    input[type="password"],
    textarea,
    select {
        font-size: 16px; // Prevent zoom on iOS
        padding: 12px;
        min-height: 44px;
    }

    // Navigation tabs
    .red-ui-tabs li {
        min-height: 44px;
        
        a {
            padding: 12px 16px;
            min-height: 44px;
            display: flex;
            align-items: center;
        }
    }
}

// Tablet optimizations
@media only screen and (min-width: #{$mobile + 1px}) and (max-width: $tablet) {
    // Tablet-specific optimizations
    #red-ui-palette {
        width: 220px;
    }

    #red-ui-workspace {
        left: 220px;
    }

    #red-ui-sidebar {
        width: 350px;
        right: 0;
    }

    .red-ui-button,
    .button {
        min-height: 40px;
        padding: 10px 14px;
    }

    // Touch-friendly workspace
    #red-ui-workspace-chart {
        touch-action: manipulation;
    }
}

// Desktop and larger screens
@media only screen and (min-width: #{$tablet + 1px}) {
    // Restore default desktop behavior
    #red-ui-palette {
        position: absolute;
        transform: none;
        transition: width 0.2s ease-in-out;
        box-shadow: none;
    }

    #red-ui-sidebar {
        position: absolute;
        transform: none;
        box-shadow: none;
    }
}

// Landscape mobile optimizations
@media only screen and (max-height: 500px) and (orientation: landscape) {
    #red-ui-header {
        height: 48px;
        
        span.red-ui-header-logo {
            font-size: 16px;
            
            span {
                display: none; // Hide text in landscape
            }
        }
    }

    #red-ui-main-container {
        top: 48px;
    }

    #red-ui-palette {
        top: 48px;
        height: calc(100vh - 48px);
        width: 240px;
    }

    #red-ui-sidebar {
        top: 48px;
        height: calc(100vh - 48px);
    }
}

// High DPI displays
@media only screen and (-webkit-min-device-pixel-ratio: 2), 
       only screen and (min-resolution: 192dpi) {
    // Sharper icons and borders
    .red-ui-palette-node,
    .red-ui-flow-node {
        border-width: 0.5px;
    }
}

// Print styles
@media print {
    #red-ui-header,
    #red-ui-palette,
    #red-ui-sidebar {
        display: none;
    }

    #red-ui-workspace {
        position: static;
        left: 0;
        right: 0;
        top: 0;
        bottom: auto;
        height: auto;
    }
}

// Accessibility - Reduced motion
@media (prefers-reduced-motion: reduce) {
    #red-ui-palette,
    #red-ui-sidebar,
    .red-ui-tabs li a,
    .button {
        transition: none;
    }
}

// Dark mode optimizations for mobile
@media (prefers-color-scheme: dark) {
    @media only screen and (max-width: $mobile) {
        #red-ui-palette,
        #red-ui-sidebar {
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.6);
        }
    }
}