/* Enhanced Mobile & Tablet CSS for Node-RED */
/* Comprehensive responsive design with intelligent touch interactions */

/* === MOBILE FIRST APPROACH (â‰¤767px) === */
@media only screen and (max-width: 767px) {
    /* Core layout - hide panels, full workspace */
    #red-ui-sidebar,
    #red-ui-palette {
        display: none !important;
        position: fixed !important;
        top: var(--red-ui-header-height, 48px) !important;
        bottom: 80px !important;
        z-index: 1000 !important;
        transform: translateX(-100%) !important;
        transition: transform 0.3s ease-in-out !important;
        box-shadow: 2px 0 12px rgba(0,0,0,0.15) !important;
    }
    
    #red-ui-palette.mobile-visible {
        display: block !important;
        transform: translateX(0) !important;
        left: 0 !important;
        width: min(300px, 85vw) !important;
    }
    
    #red-ui-sidebar.mobile-visible {
        display: block !important;
        transform: translateX(0) !important;
        right: 0 !important;
        left: auto !important;
        width: min(320px, 90vw) !important;
    }

    /* Full width workspace */
    #red-ui-workspace {
        left: 0 !important;
        right: 0 !important;
        top: var(--red-ui-header-height, 48px) !important;
        bottom: 80px !important;
    }

    /* Enhanced header for mobile */
    #red-ui-header {
        height: 48px !important;
        padding: 0 8px !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        z-index: 1002 !important;
    }
    
    .red-ui-header-button {
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 8px !important;
        margin: 2px !important;
        font-size: 16px !important;
    }

    /* Deploy button optimization */
    #red-ui-deploy-button {
        min-width: 80px !important;
        height: 44px !important;
        font-size: 14px !important;
        padding: 0 12px !important;
        border-radius: 6px !important;
    }

    /* Mobile navigation styling */
    .red-ui-mobile-nav {
        position: fixed !important;
        bottom: 20px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        background: var(--red-ui-primary-background, #ffffff) !important;
        border: 1px solid var(--red-ui-primary-border-color, #d3d3d3) !important;
        border-radius: 24px !important;
        padding: 8px 16px !important;
        box-shadow: 0 4px 16px rgba(0,0,0,0.15), 0 2px 8px rgba(0,0,0,0.1) !important;
        z-index: 1001 !important;
        display: flex !important;
        gap: 12px !important;
        align-items: center !important;
        backdrop-filter: blur(10px) !important;
    }
    
    .red-ui-mobile-nav .nav-button {
        background: none !important;
        border: none !important;
        min-width: 44px !important;
        min-height: 44px !important;
        border-radius: 50% !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        font-size: 18px !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
    }
    
    .red-ui-mobile-nav .nav-button:hover,
    .red-ui-mobile-nav .nav-button:focus {
        background: var(--red-ui-node-selected-color, rgba(0,123,255,0.1)) !important;
        transform: scale(1.05) !important;
    }
    
    .red-ui-mobile-nav .nav-button.active {
        background: var(--red-ui-deploy-button-color, #8f0000) !important;
        color: white !important;
    }

    /* Touch-friendly node palette */
    .red-ui-palette-node {
        min-height: 48px !important;
        margin: 4px 8px !important;
        padding: 12px !important;
        border-radius: 6px !important;
        font-size: 14px !important;
    }
    
    .red-ui-palette-node:active {
        transform: scale(0.95) !important;
        transition: transform 0.1s ease !important;
    }

    /* Enhanced sidebar for mobile */
    .red-ui-sidebar-tab {
        min-height: 48px !important;
        line-height: 48px !important;
        font-size: 16px !important;
        padding: 0 16px !important;
    }
    
    .red-ui-sidebar-tab:active {
        background: var(--red-ui-node-selected-color, rgba(0,123,255,0.1)) !important;
    }

    /* Mobile overlay */
    .red-ui-mobile-overlay {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        background: rgba(0,0,0,0.5) !important;
        z-index: 999 !important;
        transition: opacity 0.3s ease !important;
        backdrop-filter: blur(2px) !important;
    }

    /* Enhanced workspace scrolling */
    #red-ui-workspace-chart {
        -webkit-overflow-scrolling: touch !important;
        scroll-behavior: smooth !important;
        touch-action: pan-x pan-y !important;
    }
    
    #red-ui-workspace-chart::-webkit-scrollbar {
        width: 8px !important;
        height: 8px !important;
    }
    
    #red-ui-workspace-chart::-webkit-scrollbar-track {
        background: rgba(0,0,0,0.1) !important;
        border-radius: 4px !important;
    }
    
    #red-ui-workspace-chart::-webkit-scrollbar-thumb {
        background: rgba(0,0,0,0.3) !important;
        border-radius: 4px !important;
    }

    /* Mobile zoom controls */
    .mobile-zoom-controls {
        position: fixed !important;
        bottom: 100px !important;
        right: 20px !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
        z-index: 1001 !important;
    }
    
    .mobile-zoom-controls button {
        width: 44px !important;
        height: 44px !important;
        border: none !important;
        border-radius: 50% !important;
        background: var(--red-ui-primary-background, #fff) !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
        font-size: 20px !important;
        font-weight: bold !important;
        cursor: pointer !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    /* Connection mode toggle */
    .mobile-connection-toggle {
        position: fixed !important;
        top: 100px !important;
        right: 20px !important;
        width: 48px !important;
        height: 48px !important;
        border: none !important;
        border-radius: 50% !important;
        background: var(--red-ui-primary-background, #fff) !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2) !important;
        z-index: 1001 !important;
        font-size: 20px !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }
}

/* === LANDSCAPE MOBILE ADJUSTMENTS === */
@media (max-width: 767px) and (orientation: landscape) {
    .red-ui-mobile-nav {
        bottom: 10px !important;
    }
    
    #red-ui-workspace {
        bottom: 60px !important;
    }
    
    #red-ui-palette.mobile-visible,
    #red-ui-sidebar.mobile-visible {
        bottom: 60px !important;
        max-height: calc(100vh - 100px) !important;
    }
    
    .mobile-zoom-controls {
        bottom: 70px !important;
    }
}

/* === TABLET OPTIMIZATIONS (768px - 1024px) === */
@media only screen and (min-width: 768px) and (max-width: 1024px) {
    /* Full workspace for tablet */
    #red-ui-workspace {
        left: 0 !important;
        right: 0 !important;
    }
    
    /* Floating panels for tablet */
    #red-ui-palette,
    #red-ui-sidebar {
        position: fixed !important;
        z-index: 100 !important;
        box-shadow: 0 0 16px rgba(0,0,0,0.15) !important;
        border-radius: 8px !important;
        top: 60px !important;
        height: calc(100vh - 120px) !important;
    }
    
    #red-ui-palette {
        left: 20px !important;
        width: 220px !important;
    }
    
    #red-ui-sidebar {
        right: 20px !important;
        width: 280px !important;
    }
    
    /* Minimize functionality */
    .tablet-minimized {
        height: 48px !important;
        overflow: hidden !important;
        cursor: pointer !important;
    }
    
    .tablet-minimize-btn {
        position: absolute !important;
        top: 4px !important;
        right: 4px !important;
        width: 32px !important;
        height: 32px !important;
        border: none !important;
        background: rgba(0,0,0,0.1) !important;
        border-radius: 6px !important;
        cursor: pointer !important;
        z-index: 10 !important;
        font-size: 16px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }
    
    /* Touch enhancements for tablet */
    .red-ui-palette-node,
    .red-ui-sidebar-tab,
    .red-ui-button {
        min-height: 44px !important;
    }
    
    .red-ui-palette-node:active,
    .red-ui-sidebar-tab:active,
    .red-ui-button:active {
        transform: scale(0.98) !important;
        transition: transform 0.1s ease !important;
    }
}

/* === TOUCH DEVICE ENHANCEMENTS === */
@media (pointer: coarse) {
    /* Ensure all interactive elements meet touch guidelines */
    .red-ui-button,
    .red-ui-header-button,
    .red-ui-palette-node,
    .red-ui-sidebar-tab,
    .red-ui-tab,
    button {
        min-height: 44px !important;
        min-width: 44px !important;
        touch-action: manipulation !important;
    }
    
    .red-ui-button:active,
    .red-ui-header-button:active,
    .red-ui-palette-node:active,
    .red-ui-sidebar-tab:active,
    .red-ui-tab:active,
    button:active {
        opacity: 0.8 !important;
        transform: scale(0.95) !important;
    }
    
    /* Enhanced drag feedback for touch */
    .red-ui-palette-node.ui-draggable-dragging {
        transform: scale(1.1) !important;
        z-index: 2000 !important;
        box-shadow: 0 8px 24px rgba(0,0,0,0.3) !important;
    }
    
    /* Better node selection for touch */
    #red-ui-workspace-chart .red_ui_flow_node:active {
        filter: brightness(1.1) !important;
    }
    
    /* Enhanced port visibility for connections */
    .red-ui-flow-port {
        min-width: 16px !important;
        min-height: 16px !important;
        border: 2px solid var(--red-ui-port-border, #999) !important;
        border-radius: 50% !important;
        background: var(--red-ui-port-background, #fff) !important;
    }
    
    .red-ui-flow-port:hover,
    .red-ui-flow-port.port-highlighted {
        border-color: var(--red-ui-port-selected, #ff7f0e) !important;
        border-width: 3px !important;
        transform: scale(1.2) !important;
        box-shadow: 0 0 8px rgba(255, 127, 14, 0.5) !important;
    }
}

/* === ACCESSIBILITY ENHANCEMENTS === */
@media (prefers-reduced-motion: reduce) {
    * {
        transition-duration: 0.01ms !important;
        animation-duration: 0.01ms !important;
    }
}

/* High contrast support */
@media (prefers-contrast: high) {
    .red-ui-mobile-nav {
        border-width: 2px !important;
        box-shadow: 0 4px 16px rgba(0,0,0,0.4) !important;
    }
    
    .red-ui-mobile-nav .nav-button {
        border: 1px solid currentColor !important;
    }
    
    .red-ui-palette-node {
        border-width: 2px !important;
    }
}

/* === UTILITY CLASSES === */
.red-ui-hidden-mobile {
    @media (max-width: 767px) {
        display: none !important;
    }
}

.red-ui-hidden-tablet {
    @media (min-width: 768px) and (max-width: 1024px) {
        display: none !important;
    }
}

.red-ui-hidden-desktop {
    @media (min-width: 1025px) {
        display: none !important;
    }
}

/* === DYNAMIC CLASSES FOR DEVICE STATES === */
.red-ui-mobile .mobile-only {
    display: block !important;
}

.red-ui-tablet .tablet-only {
    display: block !important;
}

.red-ui-desktop .desktop-only {
    display: block !important;
}

.red-ui-touch .touch-only {
    display: block !important;
}

/* Hide non-relevant elements by default */
.mobile-only,
.tablet-only, 
.desktop-only,
.touch-only {
    display: none !important;
}